"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7453],{5732:(C,h,s)=>{s.d(h,{$:()=>p});var l=s(9863);let p=(()=>{class a{constructor(){}ngOnInit(){}}return a.\u0275fac=function(r){return new(r||a)},a.\u0275cmp=l.Xpm({type:a,selectors:[["app-wechat-open-page"]],decls:7,vars:0,consts:[[1,"weui-mask"],[1,"weui-dialog"],[1,"weui-dialog__bd"],[1,"weui-dialog__ft"],["href","weixin://","onclick","",1,"weui-dialog__btn","weui-dialog__btn_default"]],template:function(r,m){1&r&&(l.TgZ(0,"div",0)(1,"div",1)(2,"div",2),l._uU(3,"\u8bf7\u5728\u624b\u673a\u7aef\u6253\u5f00\u9875\u9762"),l.qZA(),l.TgZ(4,"div",3)(5,"a",4),l._uU(6,"\u786e\u5b9a"),l.qZA()()()())},styles:[""]}),a})()},7453:(C,h,s)=>{s.r(h),s.d(h,{ForgetPageModule:()=>J});var l=s(9808),p=s(3075),a=s(8962),g=s(1192),r=s(655),m=s(7846),u=s(2752),_=s(5098),v=s(4157),t=s(9863),P=s(947),x=s(9993),y=s(4884),M=s(5830),O=s(4828),b=s(9609),w=s(5161),T=s(5732),F=s(7873);const D=["appStatusContent"],S=["codeInput"];function E(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-status-content",3,4),t.NdJ("retry",function(){return t.CHM(e),t.oxw().onRetry()}),t.TgZ(3,"div",5),t._UZ(4,"app-wechat-open-page"),t.qZA()(),t.BQk()}}function I(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-status-content",3,4),t.NdJ("retry",function(){return t.CHM(e),t.oxw().onRetry()}),t.TgZ(3,"div",5),t._uU(4,"pad layout here"),t.qZA()(),t.BQk()}}function B(o,c){if(1&o&&(t.TgZ(0,"div",18),t._uU(1),t.qZA()),2&o){const e=t.oxw(2);t.xp6(1),t.hij("\u5df2\u7ed1\u624b\u673a\u53f7 ",e.ellipsisNickName(e.formData.mobile),"")}}function Z(o,c){1&o&&t._UZ(0,"ion-spinner",19)}function A(o,c){if(1&o){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-status-content",3,4),t.NdJ("retry",function(){return t.CHM(e),t.oxw().onRetry()}),t.TgZ(3,"div",5)(4,"div",6)(5,"div",7)(6,"span",8),t._uU(7,"\u901a\u8fc7\u624b\u673a\u9a8c\u8bc1\u65b9\u5f0f\u627e\u56de\u5bc6\u7801"),t.qZA(),t.TgZ(8,"div",9)(9,"div",10),t._uU(10),t.qZA(),t.YNc(11,B,2,1,"div",11),t.qZA(),t.TgZ(12,"ion-item",12)(13,"ion-input",13),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().formData.payPassword=i})("ionBlur",function(i){return t.CHM(e),t.oxw().onBlur(i)})("ionFocus",function(i){return t.CHM(e),t.oxw().onFocus(i)}),t.qZA()(),t.TgZ(14,"ion-item",12)(15,"ion-input",14),t.NdJ("ngModelChange",function(i){return t.CHM(e),t.oxw().formData.verificationCode=i})("ionBlur",function(i){return t.CHM(e),t.oxw().onBlur(i)})("ionFocus",function(i){return t.CHM(e),t.oxw().onFocus(i)}),t.qZA(),t.TgZ(16,"ion-button",15),t.NdJ("click",function(){return t.CHM(e),t.oxw().onClickSendSmsCode()}),t._uU(17),t.qZA()(),t.TgZ(18,"ion-button",16),t.NdJ("click",function(){return t.CHM(e),t.oxw().onClickBind()}),t.YNc(19,Z,1,0,"ion-spinner",17),t.TgZ(20,"span"),t._uU(21," \u63d0\u4ea4 "),t.qZA()()()()()(),t.BQk()}if(2&o){const e=t.oxw();t.xp6(10),t.hij("\u901a\u884c\u8bc1\u7f16\u53f7 NO. ",e.formData.code,""),t.xp6(1),t.Q6J("ngIf",e.formData.mobile),t.xp6(2),t.Q6J("ngModel",e.formData.payPassword)("inputmode","numeric"),t.xp6(2),t.Q6J("ngModel",e.formData.verificationCode)("inputmode","numeric"),t.xp6(1),t.Q6J("disabled",e.disabled),t.xp6(1),t.hij(" ",e.getCodeText," "),t.xp6(1),t.Q6J("disabled",e.loading),t.xp6(1),t.Q6J("ngIf",e.loading)}}const N=[{path:"",component:(()=>{class o extends m.n{constructor(e,n,i,d,f,V,Y,G,H,Q,U,z){super(e,n,i,d),this.loadingCtrl=e,this.toastCtrl=n,this.runtime=i,this.screenFitService=d,this.toastService=f,this.navCtrl=V,this.modalCtrl=Y,this.api=G,this.router=H,this.routeInfo=Q,this.eventBus=U,this.themeService=z,this.subscribeResult=null,this.routeInfoSubscribeResult=null,this.routeInfo2SubscribeResult=null,this.isBind=!1,this.loading=!1,this.isGetEmpty=!1,this.checkAgreement=!0,this.timeCountdown=60,this.getCodeText="\u83b7\u53d6\u9a8c\u8bc1\u7801",this.smsKey="",this.disabled=!1,this.timerToken=null,this.formData={channel:"",type:"",code:"",activityId:"",mobile:"",payPassword:"",verificationCode:""},this.oldScrollTop=0,this.url="",this.type=-1,this.status=0,this.inputValue="",this.visibility="hidden",this.mainColor=""}ngOnInit(){this.oldScrollTop=document.body.scrollTop,this.subscribeResult=this.router.events.subscribe(e=>{e instanceof g.m2&&"/forget"===e.url&&this.setPageTitle("\u5fd8\u8bb0\u5bc6\u7801")}),this.routeInfoSubscribeResult=this.routeInfo.params.subscribe(e=>{this.formData.channel=e.channel,this.formData.code=e.code}),this.routeInfo2SubscribeResult=this.routeInfo.queryParams.subscribe(e=>{this.formData.type=e.type,this.formData.activityId=e.activityId})}ngOnDestroy(){this.subscribeResult&&(this.subscribeResult.unsubscribe(),this.subscribeResult=null),this.routeInfoSubscribeResult&&(this.routeInfoSubscribeResult.unsubscribe(),this.routeInfoSubscribeResult=null)}setPageTitle(e){super.setPageTitle(e),this.eventBus.emmitEvent("changeNavTitle",e),this.eventBus.emmitEvent("changeDefaultHeader","standard")}initData(){return(0,r.mG)(this,void 0,void 0,function*(){this.appStatusContent.invokeLoading(),yield Promise.all([this.fetchCardInfo()]),this.smsKey=this.runtime.forgetCodeKey,window.addEventListener("resize",()=>{("INPUT"===document.activeElement.tagName||"TEXTAREA"===document.activeElement.tagName)&&setTimeout(()=>{"scrollIntoView"in document.activeElement?document.activeElement.scrollIntoView():document.activeElement.scrollIntoViewIfNeeded()},0)}),this.appStatusContent.invokeSuccess()})}ellipsisNickName(e){if(!e)return;const n=parseInt(e,10);return e.length<11||isNaN(n)?e:u.E.ellipsisPhoneNO(e)}fetchCardInfo(){return(0,r.mG)(this,void 0,void 0,function*(){const e=(0,v.d8)(_.y,yield this.api.fetchNfcCardInfo(this.formData.activityId,this.formData.type,this.formData.code,this.formData.channel));if(200!==e.code)return Promise.reject({code:e.code,message:e.msg});{const n=e.data;n&&(this.title=n.title,this.url=n.url,this.type=n.type,this.mainColor=n.colour,this.formData.mobile=n.mobile,this.status=n.status)}})}ionViewWillEnter(){this.setPageTitle("\u5fd8\u8bb0\u5bc6\u7801")}ionViewDidEnter(){(()=>(0,r.mG)(this,void 0,void 0,function*(){yield this.initData()}))().catch(e=>{console.error("[init data errror]",e),this.appStatusContent.invokeError()})}onRetry(){(()=>(0,r.mG)(this,void 0,void 0,function*(){yield this.initData()}))().catch(e=>{console.error("[init data errror]",e),this.appStatusContent.invokeError()})}back(){this.navCtrl.back()}onClickBind(){this.checkBindFormData()&&(this.loading=!0,(()=>(0,r.mG)(this,void 0,void 0,function*(){yield this.doBind(),this.loading=!1}))().catch(e=>{this.loading=!1,console.error(e)}))}checkBindFormData(){return u.E.isEmpty(this.formData.payPassword)||this.formData.payPassword.length<6?(this.showToastView("\u8bf7\u8f93\u51656\u4f4d\u5bc6\u7801!",!0),!1):u.E.isEmpty(this.formData.verificationCode)?(this.showToastView("\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",!0),!1):!(this.formData.verificationCode.length<6&&(this.showToastView("\u8bf7\u8f93\u51656\u4f4d\u9a8c\u8bc1\u7801",!0),1))}doBind(){return(0,r.mG)(this,void 0,void 0,function*(){const e={code:this.formData.code,mobile:this.formData.mobile,channel:this.formData.channel,verificationCode:this.formData.verificationCode,activityId:this.formData.activityId,payPassword:this.formData.payPassword,tokenFree:"1"},n=yield this.api.forgetPassword(e);if(200!==n.code)return yield this.showToastView(`${n.msg}`,!0),Promise.reject({code:n.code,message:n.message});yield this.showToastView("\u6210\u529f\u627e\u56de\u5bc6\u7801!",!1),this.loading=!1,yield this.back()})}ionViewDidLeave(){this.stopTimer()}checkSmsCodeFormData(){return!u.E.isEmpty(this.formData.mobile)||(this.showToastView("\u65e0\u6cd5\u901a\u8fc7\u5361\u53f7\u627e\u5230\u60a8\u7684\u624b\u673a\u53f7!",!0),!1)}showToastView(e,n=!1,i=1500,d="middle",f=!1){return(0,r.mG)(this,void 0,void 0,function*(){this.toastService.show(e,i,f?"weui-icon-success-no-circle":"weui-icon-warn")})}onClickSendSmsCode(){this.checkSmsCodeFormData()&&(()=>(0,r.mG)(this,void 0,void 0,function*(){this.disabled=!0,yield this.getSmsCode()}))().catch(e=>{this.disabled=!1,console.error(e),this.showToastView(`\u83b7\u53d6\u9a8c\u8bc1\u7801\u5931\u8d25[${e.message}]`,!0)})}getSmsCode(){return(0,r.mG)(this,void 0,void 0,function*(){const e=(0,v.d8)(_.y,yield this.api.forgetPasswordSendSms({mobile:this.formData.mobile}));if(200!==e.code)return this.showToastView("\u83b7\u53d6\u5931\u8d25\uff01"+e.msg,!0),Promise.reject({code:e.code,message:e.msg});{this.showToastView("\u83b7\u53d6\u6210\u529f",!1);const n=u.E.getNowDateString();console.log("nowDateStr -> "+n),this.runtime.setKeyValue(this.smsKey,n),this.timeCountdown=60,this.startTimer()}})}loadTimeCount(){const e=u.E.getNowDateString();console.log("nowDateStr -> "+e),this.timeCountdown=60,this.runtime.getValue(this.smsKey).then(n=>{if(console.log("codeDateStr -> "+n),!u.E.isEmpty(n)){const i=u.E.getDateDiffValue(n,e);console.log("\u65f6\u95f4\u76f8\u5dee"+i+"\u79d2"),i>0&&i<=60&&(this.disabled=!0,this.timeCountdown=60-i,this.startTimer())}}).catch(()=>{})}numberOnly(e){const n=e.which?e.which:e.keyCode;return!(n>31&&(n<48||n>57))}startTimer(){this.stopTimer(),this.timerToken=setInterval(()=>{this.timeCountdown--,this.timeCountdown>0?this.getCodeText="\u5df2\u83b7\u53d6("+this.timeCountdown+"\u79d2)":this.stopTimer()},1e3)}stopTimer(){this.timerToken&&(clearInterval(this.timerToken),this.timerToken=null,this.disabled=!1,this.getCodeText="\u83b7\u53d6\u9a8c\u8bc1\u7801")}onFocus(e){}onBlur(e){}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(a.HT),t.Y36(a.yF),t.Y36(P.t),t.Y36(x.v),t.Y36(y.kl),t.Y36(a.SH),t.Y36(a.IN),t.Y36(M.s),t.Y36(g.F0),t.Y36(g.gz),t.Y36(O.Y),t.Y36(b.f))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-forget"]],viewQuery:function(e,n){if(1&e&&(t.Gf(D,5),t.Gf(S,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.appStatusContent=i.first),t.iGM(i=t.CRH())&&(n.codeInput=i.first)}},features:[t.qOj],decls:6,vars:9,consts:[["id","pageContent",3,"fullscreen","scrollEvents"],[1,"page-root","forget"],[4,"ngIf"],[3,"retry"],["appStatusContent",""],[1,"app-container"],[1,"card-box"],[1,"bind-card","flex-col"],[1,"title"],[1,"desc"],[1,"card"],["class","mobile",4,"ngIf"],["lines","none",1,"ion-no-padding"],["type","password","maxlength","6","placeholder","\u8bbe\u7f6e6\u4f4d\u5bc6\u7801",3,"ngModel","inputmode","ngModelChange","ionBlur","ionFocus"],["type","text","maxlength","6","placeholder","\u8f93\u5165\u9a8c\u8bc1\u7801",3,"ngModel","inputmode","ngModelChange","ionBlur","ionFocus"],["expand","block","fill","clear",3,"disabled","click"],["expand","block","fill","solid",3,"disabled","click"],["name","dots",4,"ngIf"],[1,"mobile"],["name","dots"]],template:function(e,n){1&e&&(t.TgZ(0,"ion-content",0)(1,"div",1),t.YNc(2,E,5,0,"ng-container",2),t.YNc(3,I,5,0,"ng-container",2),t.YNc(4,A,22,10,"ng-container",2),t.qZA(),t._UZ(5,"app-common-footer"),t.qZA()),2&e&&(t.Tol(n.screenFitService.screenCategory),t.Q6J("fullscreen",n.themeService.immersive)("scrollEvents",!0),t.xp6(1),t.Tol(n.screenFitService.screenCategory),t.xp6(1),t.Q6J("ngIf","desktop"==n.screenFitService.screenCategory),t.xp6(1),t.Q6J("ngIf","pad"==n.screenFitService.screenCategory),t.xp6(1),t.Q6J("ngIf","phone"==n.screenFitService.screenCategory))},directives:[a.W2,l.O5,w.D,T.$,a.Ie,a.pK,a.j9,p.nD,p.JJ,p.On,a.YG,a.PQ,F.X],styles:[".flex-col[_ngcontent-%COMP%]{display:flex;flex-direction:column}.flex-row[_ngcontent-%COMP%]{display:flex;flex-direction:row}.justify-start[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.justify-center[_ngcontent-%COMP%]{display:flex;justify-content:center}.justify-end[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.justify-evenly[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly}.justify-around[_ngcontent-%COMP%]{display:flex;justify-content:space-around}.justify-between[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.align-start[_ngcontent-%COMP%]{display:flex;align-items:flex-start}.align-center[_ngcontent-%COMP%]{display:flex;align-items:center}.align-end[_ngcontent-%COMP%]{display:flex;align-items:flex-end}div.page-root.forget.phone[_ngcontent-%COMP%]{background:white;padding:0}div.page-root.forget.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]{background:white;padding:0}div.page-root.forget.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]{padding:0;background:white;height:100vh}@supports (-webkit-touch-callout: none){div.page-root.forget.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]{--height: calc(var(--vh, 1vh) * 110)}}div.page-root.forget.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]   div.card-box[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;flex-direction:column;align-content:space-between}div.page-root.forget.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]   div.card-box[_ngcontent-%COMP%] > div.bind-card[_ngcontent-%COMP%]{width:100%;height:330px;z-index:999;padding:30px 15px 0;margin-top:30px}div.page-root.forget.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]   div.card-box[_ngcontent-%COMP%] > div.bind-card[_ngcontent-%COMP%] > span.title[_ngcontent-%COMP%]{width:100%;height:28px;color:#3d464f;font-size:20px;letter-spacing:.833px;text-align:left;white-space:nowrap;line-height:28px;font-weight:700}div.page-root.forget.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]   div.card-box[_ngcontent-%COMP%] > div.bind-card[_ngcontent-%COMP%] > div.desc[_ngcontent-%COMP%]{margin-top:10px;width:100%;position:relative}div.page-root.forget.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]   div.card-box[_ngcontent-%COMP%] > div.bind-card[_ngcontent-%COMP%] > div.desc[_ngcontent-%COMP%] > div.card[_ngcontent-%COMP%]{width:100%;position:relative;font-size:14px;font-weight:400;color:#c0c6cd;line-height:20px}div.page-root.forget.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]   div.card-box[_ngcontent-%COMP%] > div.bind-card[_ngcontent-%COMP%] > div.desc[_ngcontent-%COMP%] > div.mobile[_ngcontent-%COMP%]{width:100%;position:relative;font-size:14px;font-weight:400;color:#c0c6cd;line-height:20px}div.page-root.forget.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]   div.card-box[_ngcontent-%COMP%] > div.bind-card[_ngcontent-%COMP%] > ion-item[_ngcontent-%COMP%]{display:flex;align-items:center;width:100%;margin-top:10px;--height: 44px;--border-color: #aaaaaa !important;--padding-start: 0px !important;--padding-end: 0px !important;background:#f7f7f7;pointer-events:auto}div.page-root.forget.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]   div.card-box[_ngcontent-%COMP%] > div.bind-card[_ngcontent-%COMP%] > ion-item[_ngcontent-%COMP%] > ion-input[_ngcontent-%COMP%]{width:auto;font-size:14px;--placeholder-color: #C0C6CD;--padding-start: 10px;color:#3d464f}div.page-root.forget.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]   div.card-box[_ngcontent-%COMP%] > div.bind-card[_ngcontent-%COMP%] > ion-item[_ngcontent-%COMP%] > ion-button[_ngcontent-%COMP%]{font-size:14px;margin:8px 10px;font-weight:600}div.page-root.forget.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]   div.card-box[_ngcontent-%COMP%] > div.bind-card[_ngcontent-%COMP%] > ion-button[_ngcontent-%COMP%]{position:relative;width:100%;height:45px;margin-top:15px;--ion-color-primary: #3D464F;color:#f0d6bb;font-size:14px;font-weight:600;pointer-events:auto}"]}),o})()}];let j=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[g.Bz.forChild(N)],g.Bz]}),o})();var k=s(9277),R=s(9721);let J=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[l.ez,p.u5,a.Pc,k.G,R.x,j]]}),o})()}}]);