(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-26ea"],{"1cIA":function(t,e,a){"use strict";a.r(e);var i=a("14Xm"),r=a.n(i),n=a("4d7F"),o=a.n(n),s=a("D3Ub"),c=a.n(s),l=a("QbLZ"),d=a.n(l),u=a("L2JU"),f=a("3SlJ"),m=a("yWgo"),p=a("7Qib"),g=a("KTTK"),h={name:"Register",data:function(){return{pageStatus:0,animate:null,loading:!1,sending:!1,sendCodeDisabled:!1,step:0,formData:{email:"",emailVerificationCode:"",password:"",repassword:"",verificationCode:"",nickname:"",avatar:"",inviteCode:null},timerToken:null,sendCodeButtonText:"",verificationCodePictureURL:"",encryptedVerificationCode:""}},computed:d()({},Object(u.b)(["token","language","screenCategory","immersive","color","opacity"])),watch:{language:function(){window.location.reload()},screenCategory:function(){window.location.reload()}},created:function(){var t=this;this.animate=new f.a(this),this.initData().catch(function(e){t.pageStatus=2,console.error(e)})},mounted:function(){window.addEventListener("scroll",this.handleScroll)},beforeDestroy:function(){this.stopTimer(),window.removeEventListener("scroll",this.handleScroll)},methods:{ellipsis:m.a,formatNumber:p.a,formatTimestamp:p.b,initData:function(){var t=this;return c()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.sendCodeButtonText=t.$t("register.get_code"),e.next=3,o.a.all([t.fetchRandomVerificationCodePicture()]);case 3:t.pageStatus=1,t.$nextTick(function(){t.fillAnimateRefs()});case 5:case"end":return e.stop()}},e,t)}))()},onRetry:function(){var t=this;this.pageStatus=0,this.initData().catch(function(e){t.pageStatus=2,console.error(e)})},onClickRegister:function(){var t=this;0===this.step?this.checkFormData()&&(this.step=1,this.$nextTick(function(){t.drawAvatar()})):c()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.doRegister();case 2:case"end":return e.stop()}},e,t)}))().catch(function(e){console.error(e),t.$notify({type:"error",position:"top-right",title:t.$t("common.dialog_title"),message:t.$t("common.failed",[e.message])})})},onClickGoLogin:function(){this.$router.replace("/login")},fillAnimateRefs:function(){this.animate.setAnimateData([{ref:"some-ref",classList:["animated","fadeIn"]}])},startTimer:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.stopTimer(),this.timerToken=setInterval(function(){t&&"function"==typeof t&&t()},e)},stopTimer:function(){this.timerToken&&(clearInterval(this.timerToken),this.timerToken=null)},onClickSendCode:function(){var t=this;this.formData.email?(this.sendCodeDisabled=!0,this.sending=!0,c()(r.a.mark(function e(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.sendEmailVerificationCode();case 2:t.sending=!1,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:60;t.sendCodeButtonText="60s",t.startTimer(function(){0===(e-=1)?(t.stopTimer(),t.sendCodeButtonText=t.$t("register.get_code"),t.sendCodeDisabled=!1):t.sendCodeButtonText=e+"s"})}();case 4:case"end":return e.stop()}},e,t)}))().catch(function(e){t.sendCodeDisabled=!1,t.sending=!1,console.error(e),t.$notify({type:"error",position:"top-right",title:t.$t("common.dialog_title"),message:t.$t("common.failed",[e.message])})})):this.$notify({type:"error",position:"top-right",title:this.$t("common.dialog_title"),message:this.$t("register.email_required")})},onClickRefreshAvatar:function(){this.drawAvatar()},getRandomIntByPenSize:function(t,e){for(var a=0;;)if((a=Math.floor(Math.random()*t))%e==0)return a},getSymmetry:function(t,e,a){return e-t-a},getRandomInt:function(t){return Math.floor(Math.random()*t)+1},drawAvatar:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:120,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"white",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"random",r=this.$refs.avatarCanvas,n=r.getContext("2d");r.width=t,r.height=t,"random"===i&&(i="rgb("+this.getRandomInt(255)+","+this.getRandomInt(255)+","+this.getRandomInt(255)+")"),n.fillStyle=a,n.fillRect(0,0,t,t),n.fillStyle=i;for(var o=0;o<=t;o+=e)for(var s=this.getRandomInt(t/e/2),c=0;c<s;c++){var l=this.getRandomIntByPenSize(t/2,e),d=this.getSymmetry(l,t,e);n.fillRect(l,o,e,e),n.fillRect(d,o,e,e)}var u=r.toDataURL();this.formData.avatar=u},onClickVerificationCodePicture:function(){this.fetchRandomVerificationCodePicture()},onClickRefreshVerificationCode:function(){this.fetchRandomVerificationCodePicture()},checkFormData:function(){return this.formData.email?this.formData.emailVerificationCode?this.formData.password?this.formData.repassword?this.formData.verificationCode?!(this.step>0&&!this.formData.nickname)||(this.$notify({type:"error",position:"top-right",title:this.$t("common.dialog_title"),message:this.$t("register.nickname_required")}),!1):(this.$notify({type:"error",position:"top-right",title:this.$t("common.dialog_title"),message:this.$t("register.verification_code_required")}),!1):(this.$notify({type:"error",position:"top-right",title:this.$t("common.dialog_title"),message:this.$t("register.repassword_required")}),!1):(this.$notify({type:"error",position:"top-right",title:this.$t("common.dialog_title"),message:this.$t("register.password_required")}),!1):(this.$notify({type:"error",position:"top-right",title:this.$t("common.dialog_title"),message:this.$t("register.email_verification_code_required")}),!1):(this.$notify({type:"error",position:"top-right",title:this.$t("common.dialog_title"),message:this.$t("register.email_required")}),!1)},sendEmailVerificationCode:function(){var t=this;return c()(r.a.mark(function e(){var a,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.c)(t.formData.email);case 2:if(1!==(a=e.sent).Status){e.next=6;break}e.next=7;break;case 6:return e.abrupt("return",o.a.reject({code:a.ErrCode,message:a.ErrMsg}));case 7:return e.next=9,Object(g.J)(t.formData.email,0);case 9:if(1!==(i=e.sent).Status){e.next=14;break}t.$message({type:"success",message:t.$t("common.success")}),e.next=15;break;case 14:return e.abrupt("return",o.a.reject({code:i.ErrCode,message:i.ErrMsg}));case 15:case"end":return e.stop()}},e,t)}))()},fetchRandomVerificationCodePicture:function(){var t=this;return c()(r.a.mark(function e(){var a,i;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(g.B)();case 2:if(1!==(a=e.sent).Status){e.next=9;break}i=a.Result,t.verificationCodePictureURL="data:image/png;base64,"+i.img,t.encryptedVerificationCode=i.code_encrypt,e.next=10;break;case 9:return e.abrupt("return",o.a.reject({code:a.ErrCode,message:a.ErrMsg}));case 10:case"end":return e.stop()}},e,t)}))()},doRegister:function(){var t=this;return c()(r.a.mark(function e(){var a;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.checkFormData()){e.next=10;break}return e.next=3,Object(g.F)(t.formData.email,t.formData.nickname,t.formData.emailVerificationCode,t.formData.verificationCode,t.formData.password,t.formData.repassword,t.encryptedVerificationCode,t.formData.avatar,t.formData.inviteCode);case 3:if(1!==(a=e.sent).Status){e.next=9;break}t.$message({type:"success",message:t.$t("register.congratulations")}),t.$router.replace("/login"),e.next=10;break;case 9:return e.abrupt("return",o.a.reject({code:a.ErrCode,message:a.ErrMsg}));case 10:case"end":return e.stop()}},e,t)}))()},handleScroll:function(){var t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;this.animate.onScroll(t)}}},v=(a("wkrj"),a("2GJs"),a("KHd+")),C=Object(v.a)(h,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"page-root register",class:t.screenCategory+" "+t.language},[a("status-container",{attrs:{status:t.pageStatus},on:{retry:function(e){t.onRetry()}}},["pc"==t.screenCategory?[a("div",{staticClass:"container"},[a("div",{staticClass:"content-wrapper"},[a("div",{staticClass:"slot-start"},[a("div",{staticClass:"background"},[a("div",{staticClass:"background-inner"},[a("div",{staticClass:"top"}),t._v(" "),a("div",{staticClass:"center"}),t._v(" "),a("div",{staticClass:"bottom"})])]),t._v(" "),a("div",{staticClass:"text-wrapper"},[a("div",{staticClass:"content-inner"},[a("div",{staticClass:"quote-symbol"},[a("svg-icon",{attrs:{"icon-class":"icon_quote"}})],1),t._v(" "),a("div",{staticClass:"slogan",domProps:{innerHTML:t._s(t.$t("register.slogan"))}})])])]),t._v(" "),a("div",{staticClass:"slot-end"},[0==t.step?[a("div",{staticClass:"step-01-wrapper"},[a("div",{staticClass:"title"},[t._v(t._s(t.$t("register.title")))]),t._v(" "),a("div",{staticClass:"form-wrapper"},[a("el-input",{attrs:{placeholder:t.$t("register.email_placeholder"),size:"normal"},model:{value:t.formData.email,callback:function(e){t.$set(t.formData,"email",e)},expression:"formData.email"}}),t._v(" "),a("el-input",{attrs:{placeholder:t.$t("register.email_verification_code_placeholder"),size:"normal"},model:{value:t.formData.emailVerificationCode,callback:function(e){t.$set(t.formData,"emailVerificationCode",e)},expression:"formData.emailVerificationCode"}},[a("div",{staticClass:"append-wrapper",attrs:{slot:"append"},slot:"append"},[a("el-button",{attrs:{disabled:t.sendCodeDisabled,loading:t.sending,type:"text",size:"default"},on:{click:function(e){t.onClickSendCode()}}},[t._v(t._s(t.sendCodeButtonText))])],1)]),t._v(" "),a("el-input",{attrs:{placeholder:t.$t("register.password_placeholder"),type:"password",size:"normal"},model:{value:t.formData.password,callback:function(e){t.$set(t.formData,"password",e)},expression:"formData.password"}}),t._v(" "),a("el-input",{attrs:{placeholder:t.$t("register.repassword_placeholder"),type:"password",size:"normal"},model:{value:t.formData.repassword,callback:function(e){t.$set(t.formData,"repassword",e)},expression:"formData.repassword"}}),t._v(" "),a("el-input",{attrs:{placeholder:t.$t("register.verification_code_placeholder"),size:"normal"},model:{value:t.formData.verificationCode,callback:function(e){t.$set(t.formData,"verificationCode",e)},expression:"formData.verificationCode"}},[a("div",{staticClass:"verification-code-picture",attrs:{slot:"append"},on:{click:function(e){t.onClickVerificationCodePicture()}},slot:"append"},[a("img",{attrs:{src:t.verificationCodePictureURL,alt:""}})])]),t._v(" "),a("div",{staticClass:"refresh-wrapper"},[a("span",{on:{click:function(e){t.onClickRefreshVerificationCode()}}},[t._v(t._s(t.$t("register.refresh")))])]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"large"},on:{click:function(e){t.onClickRegister()}}},[t._v(t._s(t.$t("register.next_step")))])],1),t._v(" "),a("div",{staticClass:"footer"},[a("span",{on:{click:function(e){t.onClickGoLogin()}}},[t._v(t._s(t.$t("register.go_login")))])])])]:[a("div",{staticClass:"step-02-wrapper"},[a("div",{staticClass:"form-wrapper"},[a("div",{staticClass:"upload-wrapper"},[a("div",{staticClass:"avatar-wrapper"},[a("el-image",{attrs:{src:t.formData.avatar,lazy:!1,fit:"cover"}}),t._v(" "),a("div",{staticClass:"avatar-canvas-wrapper",on:{click:function(e){t.onClickRefreshAvatar()}}},[a("canvas",{ref:"avatarCanvas"}),t._v(" "),a("svg-icon",{attrs:{"icon-class":"icon_refresh"}})],1)],1),t._v(" "),a("span",[t._v(t._s(t.$t("register.upload_avatar")))])]),t._v(" "),a("el-input",{attrs:{placeholder:t.$t("register.nickname_placeholder"),size:"normal"},model:{value:t.formData.nickname,callback:function(e){t.$set(t.formData,"nickname",e)},expression:"formData.nickname"}}),t._v(" "),a("el-button",{attrs:{loading:t.loading,type:"primary",size:"large"},on:{click:function(e){t.onClickRegister()}}},[t._v(t._s(t.$t("register.register")))])],1)])]],2)])])]:void t.screenCategory],2)],1)},[],!1,null,"0ae20dd8",null);C.options.__file="index.vue";e.default=C.exports},"2GJs":function(t,e,a){"use strict";var i=a("gXWd");a.n(i).a},"6cao":function(t,e,a){a("h6RI"),t.exports=Math.pow(2,-52)},"7Qib":function(t,e,a){"use strict";a.d(e,"b",function(){return l}),a.d(e,"a",function(){return d});var i=a("14Xm"),r=a.n(i),n=a("4d7F"),o=a.n(n),s=a("D3Ub"),c=a.n(s);a("mjEM"),a("mSNy");function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"yyyy-MM-dd hh:mm:ss";return Date.prototype.format=function(t){var e={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var a in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),e)new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1===RegExp.$1.length?e[a]:("00"+e[a]).substr((""+e[a]).length)));return t},new Date(t).format(e)}function d(t){return t?t.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,"):0}!function(){var t=c()(r.a.mark(function t(e){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new o.a(function(t,a){try{var i=new FileReader;i.readAsDataURL(e),i.onload=function(e){var a=e.target.result;t(a)}}catch(t){a(t)}}));case 1:case"end":return t.stop()}},t,this)}))}()},OX9i:function(t,e,a){},gXWd:function(t,e,a){},h6RI:function(t,e,a){var i=a("Y7ZC");i(i.S,"Number",{EPSILON:Math.pow(2,-52)})},mjEM:function(t,e,a){t.exports={default:a("6cao"),__esModule:!0}},wkrj:function(t,e,a){"use strict";var i=a("OX9i");a.n(i).a}}]);