(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-f54b"],{FdTB:function(e,r,t){},K0zz:function(e,r){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAaElEQVQ4T2NkoDJgpLJ5DEQZWO/+7DDI4sadUraEHECUgXVuz/6DDGraJUVQPUEFIINGDcQbL7QLQ1DS+P+fwYZQssAmz8jIcASWpOAupLqB+Fw2mmwGKNnQNVKoXnyRktiJynqkGAgAFfhGFbK/J0gAAAAASUVORK5CYII="},KQRV:function(e,r){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAACvUlEQVQ4T71UTUhUURg95z0dlcxSI50Ba5cQuGoTJLVITZOoqKFCU/OvNi3aRAU6zwxqEbgLQse01P6shBAZraAQiiioaJVBf6DTBGWSY6n3fvHGcTKbERfS2zzeve873znnnu8SS/xwifGwIODxTV+WJyZP7aegQoBEwGgzONVp+bK+xiISFdCTF8iFqaq0iJvAMgDvAKwAkAbgJ8Eekl6PL+M+QZkLHgG0tgcyRakyEakEkA1gDMBNIdobfc7Bo0VvHekqeYcCygkpBBAH8D2g26h5qeGe66MNHAKsLxi5AKAakHiCDzTF+2NM3Wl6nDURTdqprZ8zTEOVkKgNN9ckuxt8zn1hwOHbAHaHiwMEuihx7dbA6hfzAd1uMbPHRvJNYbmI7ASRFGJGDDb4nJsjkuvy/Dk0dZUISgmkzwDxlYi0K212mnF6FUWXA0YJIK7w/neA1wxKq+VzPo1InsvCcosDY/5dGlIJYR4gJgAFwH5DACH4yCBa4ZBu664r+M+h1BcMP58pMLyT8b86zvWu/Wb/5MkbXqPJClIOAXQQclmJaj0zkDVk758o/pDqmEooBXSV3fR0v2tDSLKnYLhJBIdDfggmSOOWFmlpHHA+nOkuoWzMRqQuf2SLQVaL6D1/anCxod91LOLh2eLR1OBU8CBB+7RzZnDwRiBek2ab/alEVRCsArEuLPO1AaM5IT7xysnelSFVUYNtFfk3ipIaDbFjYAd7MgzgEGDcAK/TZLPVl/lkfgpmYxPVQ6toKEVPpxwAVU2IsKDFjEvosvrS7dAv5KG/SaCPwJ7XqB7+zWNRHlrbPqUpmGXUrAFl/SI9fClki5mU2GH1pI7G9NBTGMgVUbXQsjc8CREPwzN+1RC0WAOuZ1E9jDav9pp98hPTwTIIbA9HQfEGxbxxvj9zPFbN/71gY7FYaP03EGE4JFlByZoAAAAASUVORK5CYII="},WxD3:function(e,r,t){"use strict";var s=t("FdTB");t.n(s).a},vIeG:function(e,r,t){"use strict";t.r(r);var s=t("KTTK"),o={name:"ConfirmOrder",data:function(){return{modifyAddressFlag:!1,hasProvince:!1,hasCity:!1,provinceList:[],cityList:[],regionList:[],from:"",paramsData:"",paramsCount:"",modifyAddressForm:{name:"",province:"",city:"",region:"",detailAddress:"",phone:"",isDefault:!1},currentAddress:null,rules:{name:[{required:!0,message:this.$t("confirm_order.rules.name.required"),trigger:"blur"},{max:60,message:this.$t("confirm_order.rules.name.required"),trigger:"blur"}],region:[{required:!0,message:this.$t("confirm_order.rules.region.required"),trigger:"blur"}],detailAddress:[{required:!0,message:this.$t("confirm_order.rules.address.required"),trigger:"blur"},{max:200,message:this.$t("confirm_order.rules.address.range")}],phone:[{required:!0,message:this.$t("confirm_order.rules.phone.required"),trigger:"blur"}]},progressStarted:!1,receiveAddressList:[],invoiceInformation:{},express:{name:"express-name",amount_en:0,amount:0},withInvoiceOrNot:!1,isCheckedCompany:!1,cartGoodsList:[],remark:"",isLoading:!1}},created:function(){this.fetchAddressList(),this.fetchEnterpriseInformation(),this.getRouteParams()},mounted:function(){var e=this;this.$nextTick(function(){setTimeout(function(){e.progressStarted=!0},300)})},methods:{fetchProvince:function(){var e=this;s.r(0).then(function(r){1===r.Status?e.provinceList=r.Result:e.$notify.error({title:e.$t("common.dialog_title"),message:r.ErrMsg})}).catch(function(r){console.error(r),e.$notify.error({title:e.$t("common.dialog_title"),message:r.message})})},fetchCity:function(e){var r=this;s.r(1,e).then(function(e){1===e.Status?r.cityList=e.Result:r.$notify.error({title:r.$t("common.dialog_title"),message:e.ErrMsg})}).catch(function(e){console.error(e),r.$notify.error({title:r.$t("common.dialog_title"),message:e.message})})},fetchRegion:function(e){var r=this;s.r(2,e).then(function(e){1===e.Status?r.regionList=e.Result:r.$notify.error({title:r.$t("common.dialog_title"),message:e.ErrMsg})}).catch(function(e){console.error(e),r.$notify.error({title:r.$t("common.dialog_title"),message:e.message})})},fetchEnterpriseInformation:function(){var e=this;s.l().then(function(r){1===r.Status&&(e.invoiceInformation=r.Result)}).catch(function(e){console.error(e)})},postModifyAddress:function(){var e=this;s.x(this.modifyAddressForm.name,this.modifyAddressForm.province,this.modifyAddressForm.city,this.modifyAddressForm.region,this.modifyAddressForm.detailAddress,this.modifyAddressForm.phone,this.modifyAddressForm.isDefault).then(function(r){1===r.Status?(e.modifyAddressFlag=!1,e.$notify.success({title:e.$t("common.dialog_title"),message:e.$t("common.success")}),e.fetchAddressList()):(console.error(r.ErrMsg),e.$notify.error({title:e.$t("common.dialog_title"),message:r.ErrMsg}))}).catch(function(r){console.error(r),e.$notify.error({title:e.$t("common.dialog_title"),message:r.message})})},fetchAddressList:function(){var e=this;s.g().then(function(r){1===r.Status?(e.receiveAddressList=r.Result,e.receiveAddressList&&e.receiveAddressList.length>0&&null==e.currentAddress&&(e.receiveAddressList.forEach(function(r){r.is_default&&(e.currentAddress=r)}),null==e.currentAddress&&(e.currentAddress=e.receiveAddressList[0]))):204!==r.ErrCode&&e.$notify.error({title:e.$t("common.dialog_title"),message:r.ErrMsg})}).catch(function(r){console.error(r),e.$parent.$parent.showCommonErrorDialog(function(){e.fetchAddressList()})})},postGenerateOrder:function(){var e=this;if(null!==this.currentAddress){if("goods-detail"===this.from)this.isLoading=!0,s.f(this.currentAddress.id,null,this.paramsData.id,this.paramsCount,this.remark,this.withInvoiceOrNot).then(function(r){if(e.isLoading=!1,1===r.Status){var t=r.Result.order_id;e.$router.replace({name:"PayOrder",params:{orderId:t}})}else e.$notify.error({title:e.$t("common.dialog_title"),message:r.ErrMsg})}).catch(function(r){e.isLoading=!1,console.error(r),e.$notify.error({title:e.$t("common.dialog_title"),message:r.message})});else if("shopcart"===this.from){var r=[];this.cartGoodsList.forEach(function(e){r.push(e.id)}),this.isLoading=!0,s.f(this.currentAddress.id,r,null,null,this.remark,this.withInvoiceOrNot).then(function(r){if(e.isLoading=!1,1===r.Status){var t=r.Result.order_id;e.$router.replace({name:"PayOrder",params:{orderId:t}})}else e.$notify.error({title:e.$t("common.dialog_title"),message:r.ErrMsg})}).catch(function(r){e.isLoading=!1,console.error(r),e.$notify.error({title:e.$t("common.dialog_title"),message:r.message})})}}else this.$notify.error({title:this.$t("common.dialog_title"),message:this.$t("confirm_order.none_address")})},handleSelectProvince:function(e){this.hasProvince=!0,this.hasCity=!1,this.modifyAddressForm.province=e,this.modifyAddressForm.city=null,this.modifyAddressForm.region=null,this.fetchCity(e)},handleSelectCity:function(e){this.hasCity=!0,this.modifyAddressForm.city=e,this.modifyAddressForm.region=null,this.fetchRegion(e)},handleSelectRegion:function(e){this.modifyAddressForm.region=e},handleModifyAddressConfirm:function(){var e=this;this.$refs.modifyAddressForm.validate(function(r){if(!r)return!1;e.postModifyAddress()})},handleAddressSelect:function(e){this.currentAddress=e},getRouteParams:function(){var e=this.$route.params.from;e?localStorage.setItem("confirm-order-key-from",e):e=localStorage.getItem("confirm-order-key-from"),this.from=e;var r=this.$route.params.count;r?localStorage.setItem("confirm-order-key-count",r):r=localStorage.getItem("confirm-order-key-count"),this.paramsCount=r;var t=this.$route.params.data;t?localStorage.setItem("confirm-order-key-data",t):t=localStorage.getItem("confirm-order-key-data"),t&&(this.paramsData=JSON.parse(t),"goods-detail"===e?this.cartGoodsList=[{id:this.paramsData.id,name:this.paramsData.name,name_en:this.paramsData.name_en,logo:this.paramsData.logo,price:this.paramsData.price,cnt:this.paramsCount}]:"shopcart"===e&&(this.cartGoodsList=this.paramsData))},getTotalAmount:function(){if(this.cartGoodsList.length>0){var e=0;return this.cartGoodsList.forEach(function(r){e+=r.price*r.cnt}),this.$t("common.currency_symbol")+e}},handleSubmit:function(){this.postGenerateOrder()},handleManageAddress:function(){this.$router.push({name:"PersonalCenter",params:{from:"confirm-order",command:"manage"}})},handleAddAddress:function(){this.modifyAddressFlag=!0,this.fetchProvince()}}},i=(t("WxD3"),t("KHd+")),n=Object(i.a)(o,function(){var e=this,r=e.$createElement,s=e._self._c||r;return s("div",{staticClass:"confirm-order-container"},[s("div",{staticClass:"main-content"},[s("div",{staticClass:"status-indication-wrapper"},[s("span",{class:e.progressStarted?"active":""},[e._v("\n        "+e._s(e.$t("confirm_order.status_01"))+"\n      ")]),e._v(" "),s("span",[e._v("\n        "+e._s(e.$t("confirm_order.status_02"))+"\n      ")]),e._v(" "),s("span",[e._v("\n        "+e._s(e.$t("confirm_order.status_03"))+"\n      ")])]),e._v(" "),s("h4",[e._v("\n      "+e._s(e.$t("confirm_order.choose_receive_address"))+"\n    ")]),e._v(" "),s("div",{staticClass:"receive-address-list"},e._l(e.receiveAddressList,function(r,t){return s("div",{key:t,staticClass:"receive-address-item",class:e.currentAddress&&e.currentAddress.id===r.id?"active":"",on:{click:function(t){e.handleAddressSelect(r)}}},[s("div",{staticClass:"name-wrapper"},[s("span",[e._v("\n            "+e._s(r.name)+"\n          ")]),e._v(" "),s("span",[e._v("\n            "+e._s(r.is_default?e.$t("confirm_order.default"):"")+"\n          ")])]),e._v(" "),s("div",{staticClass:"detail-address-wrapper"},[s("span",[e._v("\n            "+e._s(e.$t("confirm_order.detail_address"))+"\n          ")]),e._v(" "),s("span",[e._v("\n            "+e._s(r.detail_address)+"\n          ")])]),e._v(" "),s("div",{staticClass:"phone-wrapper"},[s("span",[e._v("\n            "+e._s(e.$t("confirm_order.phone"))+"\n          ")]),e._v(" "),s("span",[e._v("\n            "+e._s(r.phone)+"\n          ")])])])})),e._v(" "),s("div",{staticClass:"receive-address-operation"},[s("div",{staticClass:"manage-receive-address",on:{click:function(r){e.handleManageAddress()}}},[s("img",{attrs:{src:t("KQRV")}}),e._v(" "),s("span",[e._v("\n          "+e._s(e.$t("confirm_order.manage_receive_address"))+"\n        ")])]),e._v(" "),s("div",{staticClass:"add-receive-address",on:{click:function(r){e.handleAddAddress()}}},[s("img",{attrs:{src:t("K0zz")}}),e._v(" "),s("span",[e._v("\n          "+e._s(e.$t("confirm_order.create_receive_address"))+"\n        ")])])]),e._v(" "),s("h4",[e._v("\n      "+e._s(e.$t("confirm_order.invoice_information"))+"\n      "),s("el-checkbox",{attrs:{label:e.$t("confirm_order.is_invoice")},model:{value:e.withInvoiceOrNot,callback:function(r){e.withInvoiceOrNot=r},expression:"withInvoiceOrNot"}})],1),e._v(" "),s("div",{staticClass:"invoice-information-wrapper"},[s("h4",[e._v("\n        "+e._s(e.$t("confirm_order.invoice_header",[e.invoiceInformation.name,e.invoiceInformation.business_license]))+"\n      ")]),e._v(" "),s("p",[e._v("\n        "+e._s(e.$t("confirm_order.invoice_tips"))+"\n      ")])]),e._v(" "),s("h4",[e._v("\n      "+e._s(e.$t("confirm_order.confirm_goods_information"))+"\n    ")]),e._v(" "),s("el-table",{attrs:{data:e.cartGoodsList,"tooltip-effect":"dark"}},[s("el-table-column",{attrs:{label:e.$t("confirm_order.goods_information"),"class-name":"goods-info-column","label-class-name":"goods-info-column-label",width:"540"},scopedSlots:e._u([{key:"default",fn:function(r){return[s("el-image",{attrs:{src:r.row.logo,fit:"cover"}}),e._v(" "),s("span",[e._v("\n            "+e._s(r.row.name)+"\n          ")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("confirm_order.price"),"min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(r){return[e._v("\n          "+e._s(e.$t("common.currency_symbol")+r.row.price)+"\n        ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("confirm_order.count"),prop:"cnt","min-width":"80"}}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("confirm_order.amount"),"class-name":"amount-column","label-class-name":"amount-column-label","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(r){return[e._v("\n          "+e._s(e.$t("common.currency_symbol")+r.row.price*r.row.cnt)+"\n        ")]}}])}),e._v(" "),s("el-table-column",{attrs:{label:e.$t("common.operation"),"min-width":"80"},scopedSlots:e._u([{key:"default",fn:function(r){return[s("el-button",{attrs:{type:"text"},on:{click:function(t){e.handleDeleteItem(r.row)}}},[e._v("\n            "+e._s(e.$t("common.delete"))+"\n          ")])]}}])})],1),e._v(" "),s("div",{staticClass:"remark-and-express"},[s("div",{staticClass:"remark"},[s("span",[e._v("\n          "+e._s(e.$t("confirm_order.remark"))+"\n        ")]),e._v(" "),s("el-input",{attrs:{placeholder:e.$t("confirm_order.remark_placehold")},model:{value:e.remark,callback:function(r){e.remark=r},expression:"remark"}})],1)])],1),e._v(" "),s("div",{staticClass:"confirm-order-footer"},[s("div",{staticClass:"main-content"},[s("span",[e._v("\n        "+e._s(e.$t("confirm_order.total"))+"\n      ")]),e._v(" "),s("span",[e._v("\n        "+e._s(e.getTotalAmount())+"\n      ")]),e._v(" "),s("el-button",{attrs:{round:!0,type:"primary"},on:{click:function(r){e.handleSubmit()}}},[e._v("\n        "+e._s(e.$t("confirm_order.submit"))+"\n      ")])],1)]),e._v(" "),s("el-dialog",{staticClass:"modify-address-dialog",attrs:{"close-on-click-modal":!1,visible:e.modifyAddressFlag},on:{"update:visible":function(r){e.modifyAddressFlag=r}}},[s("div",{staticClass:"modify-address-dialog-content"},[s("h4",[e._v("\n        "+e._s(e.$t("confirm_order.dialog.edit_receive_address.title"))+"\n      ")]),e._v(" "),s("div",{staticClass:"content-wrapper"},[s("el-form",{ref:"modifyAddressForm",attrs:{rules:e.rules,model:e.modifyAddressForm,"label-width":"120px"}},[s("el-form-item",{attrs:{label:e.$t("confirm_order.dialog.edit_receive_address.receiver_name"),prop:"name"}},[s("el-input",{attrs:{placeholder:e.$t("confirm_order.dialog.edit_receive_address.receiver_name_placehold")},model:{value:e.modifyAddressForm.name,callback:function(r){e.$set(e.modifyAddressForm,"name",r)},expression:"modifyAddressForm.name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("confirm_order.dialog.edit_receive_address.region"),prop:"region"}},[s("el-select",{attrs:{placeholder:e.$t("confirm_order.dialog.edit_receive_address.choose_province")},on:{change:e.handleSelectProvince},model:{value:e.modifyAddressForm.province,callback:function(r){e.$set(e.modifyAddressForm,"province",r)},expression:"modifyAddressForm.province"}},e._l(e.provinceList,function(e,r){return s("el-option",{key:r,attrs:{label:e.name,value:e.code}})})),e._v(" "),s("el-select",{attrs:{disabled:!e.hasProvince,placeholder:e.$t("confirm_order.dialog.edit_receive_address.choose_city")},on:{change:e.handleSelectCity},model:{value:e.modifyAddressForm.city,callback:function(r){e.$set(e.modifyAddressForm,"city",r)},expression:"modifyAddressForm.city"}},e._l(e.cityList,function(e,r){return s("el-option",{key:r,attrs:{label:e.name,value:e.code}})})),e._v(" "),s("el-select",{attrs:{disabled:!e.hasCity,placeholder:e.$t("confirm_order.dialog.edit_receive_address.choose_district")},on:{change:e.handleSelectRegion},model:{value:e.modifyAddressForm.region,callback:function(r){e.$set(e.modifyAddressForm,"region",r)},expression:"modifyAddressForm.region"}},e._l(e.regionList,function(e,r){return s("el-option",{key:r,attrs:{label:e.name,value:e.code}})}))],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("confirm_order.dialog.edit_receive_address.detail_address"),prop:"detailAddress"}},[s("el-input",{attrs:{placeholder:e.$t("confirm_order.dialog.edit_receive_address.detail_address_placehold")},model:{value:e.modifyAddressForm.detailAddress,callback:function(r){e.$set(e.modifyAddressForm,"detailAddress",r)},expression:"modifyAddressForm.detailAddress"}})],1),e._v(" "),s("el-form-item",{attrs:{label:e.$t("confirm_order.dialog.edit_receive_address.phone_number"),prop:"phone"}},[s("el-input",{attrs:{placeholder:e.$t("confirm_order.dialog.edit_receive_address.phone_number_placehold")},model:{value:e.modifyAddressForm.phone,callback:function(r){e.$set(e.modifyAddressForm,"phone",r)},expression:"modifyAddressForm.phone"}})],1),e._v(" "),s("el-form-item",[s("el-checkbox",{attrs:{label:e.$t("confirm_order.dialog.edit_receive_address.set_default")},model:{value:e.modifyAddressForm.isDefault,callback:function(r){e.$set(e.modifyAddressForm,"isDefault",r)},expression:"modifyAddressForm.isDefault"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{round:!0},on:{click:function(r){e.modifyAddressFlag=!1}}},[e._v(e._s(e.$t("common.cancel")))]),e._v(" "),s("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.isLoading,expression:"isLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{round:!0,type:"primary"},on:{click:function(r){e.handleModifyAddressConfirm()}}},[e._v(e._s(e.$t("common.confirm")))])],1)],1)],1)])])],1)},[],!1,null,"7344969f",null);n.options.__file="index.vue";r.default=n.exports}}]);