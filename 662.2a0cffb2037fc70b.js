"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[662],{5732:(m,g,i)=>{i.d(g,{$:()=>d});var r=i(9863);let d=(()=>{class a{constructor(){}ngOnInit(){}}return a.\u0275fac=function(p){return new(p||a)},a.\u0275cmp=r.Xpm({type:a,selectors:[["app-wechat-open-page"]],decls:7,vars:0,consts:[[1,"weui-mask"],[1,"weui-dialog"],[1,"weui-dialog__bd"],[1,"weui-dialog__ft"],["href","weixin://","onclick","",1,"weui-dialog__btn","weui-dialog__btn_default"]],template:function(p,y){1&p&&(r.TgZ(0,"div",0)(1,"div",1)(2,"div",2),r._uU(3,"\u8bf7\u5728\u624b\u673a\u7aef\u6253\u5f00\u9875\u9762"),r.qZA(),r.TgZ(4,"div",3)(5,"a",4),r._uU(6,"\u786e\u5b9a"),r.qZA()()()())},styles:[""]}),a})()},662:(m,g,i)=>{i.r(g),i.d(g,{AlipayPageModule:()=>H});var r=i(9808),d=i(3075),a=i(8962),c=i(1192),p=i(655),y=i(7846),v=i(5098),C=i(4157),t=i(9863),P=i(947),x=i(9993),A=i(4828),T=i(5830),M=i(9609),S=i(5161),B=i(5732),O=i(7873),E=i(5436);const F=["appStatusContent"],Z=["element"];function j(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-status-content",3,4),t.NdJ("retry",function(){return t.CHM(e),t.oxw().onRetry()}),t._UZ(3,"app-wechat-open-page"),t.qZA(),t.BQk()}}function Y(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-status-content",3,4),t.NdJ("retry",function(){return t.CHM(e),t.oxw().onRetry()}),t.TgZ(3,"div",5),t._uU(4,"pad layout here"),t.qZA()(),t.BQk()}}function _(n,l){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-status-content",3,4),t.NdJ("retry",function(){return t.CHM(e),t.oxw().onRetry()}),t.TgZ(3,"div",5),t._UZ(4,"div",6,7),t.ALo(6,"safe"),t.qZA()(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(4),t.Q6J("innerHTML",t.xi3(6,1,e.htmlSnippet,"html"),t.oJD)}}const I=function(n){return{immersive:n}},w=[{path:"",component:(()=>{class n extends y.n{constructor(e,o,s,u,f,k,D,G,N,U,W){super(e,o,s,u),this.loadingCtrl=e,this.toastCtrl=o,this.runtime=s,this.screenFitService=u,this.navCtrl=f,this.eventBus=k,this.modalCtrl=D,this.api=G,this.routeInfo=N,this.router=U,this.themeService=W,this.htmlSnippet="",this.orderId=null,this.isBook=!1,this.routeInfo.params.subscribe(h=>{this.orderId=h.orderId,this.isBook="book"===h.isBook,console.log("book="+this.isBook)})}ngOnInit(){this.router.events.subscribe(e=>{e instanceof c.m2&&"/alipay"===e.url&&this.setPageTitle("\u652f\u4ed8\u5b9d\u652f\u4ed8")})}initData(){return(0,p.mG)(this,void 0,void 0,function*(){this.fetchOrderAlipay(),this.appStatusContent.invokeSuccess()})}setPageTitle(e){super.setPageTitle(e),this.eventBus.emmitEvent("changeNavTitle",e),this.eventBus.emmitEvent("changeDefaultHeader","standard"),this.eventBus.emmitEvent("changeShowRightBar","none")}fetchOrderAlipay(){return(0,p.mG)(this,void 0,void 0,function*(){const e=window.location.href;let o=2;"phone"===this.screenFitService.screenCategory&&(o=4),console.log("isbook="+this.isBook);const s=(0,C.d8)(v.y,yield this.api.orderPay(this.orderId,o,null,null,this.isBook,e));if(200===s.code){const u=s.data;if(u){this.appStatusContent.invokeSuccess(),this.htmlSnippet=u,this.element=this.viewElement.nativeElement;const f=document.createRange().createContextualFragment(this.htmlSnippet);this.element.appendChild(f)}}else this.showToast(s.msg,!0),this.appStatusContent.invokeError("assets/images/bought_no_data.png",s.msg,"","\u5237\u65b0")})}ionViewWillEnter(){this.setPageTitle("\u652f\u4ed8\u5b9d\u652f\u4ed8")}ionViewDidEnter(){(()=>(0,p.mG)(this,void 0,void 0,function*(){yield this.initData()}))().catch(e=>{console.error("[init data errror]",e),this.appStatusContent.invokeError()})}onRetry(){(()=>(0,p.mG)(this,void 0,void 0,function*(){yield this.initData()}))().catch(e=>{console.error("[init data errror]",e),this.appStatusContent.invokeError()})}back(){this.navCtrl.back()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(a.HT),t.Y36(a.yF),t.Y36(P.t),t.Y36(x.v),t.Y36(a.SH),t.Y36(A.Y),t.Y36(a.IN),t.Y36(T.s),t.Y36(c.gz),t.Y36(c.F0),t.Y36(M.f))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-alipay"]],viewQuery:function(e,o){if(1&e&&(t.Gf(F,5),t.Gf(Z,5)),2&e){let s;t.iGM(s=t.CRH())&&(o.appStatusContent=s.first),t.iGM(s=t.CRH())&&(o.viewElement=s.first)}},features:[t.qOj],decls:6,vars:12,consts:[["id","pageContent",3,"fullscreen","scrollEvents"],[1,"page-root","alipay",3,"ngClass"],[4,"ngIf"],[3,"retry"],["appStatusContent",""],[1,"app-container"],[3,"innerHTML"],["element",""]],template:function(e,o){1&e&&(t.TgZ(0,"ion-content",0)(1,"div",1),t.YNc(2,j,4,0,"ng-container",2),t.YNc(3,Y,5,0,"ng-container",2),t.YNc(4,_,7,4,"ng-container",2),t.qZA(),t._UZ(5,"app-common-footer"),t.qZA()),2&e&&(t.Tol(o.screenFitService.screenCategory),t.Q6J("fullscreen",o.themeService.immersive)("scrollEvents",!0),t.xp6(1),t.Tol(o.screenFitService.screenCategory),t.Q6J("ngClass",t.VKq(10,I,o.themeService.immersive)),t.xp6(1),t.Q6J("ngIf","desktop"==o.screenFitService.screenCategory),t.xp6(1),t.Q6J("ngIf","pad"==o.screenFitService.screenCategory),t.xp6(1),t.Q6J("ngIf","phone"==o.screenFitService.screenCategory))},directives:[a.W2,r.mk,r.O5,S.D,B.$,O.X],pipes:[E.y],styles:[".flex-col[_ngcontent-%COMP%]{display:flex;flex-direction:column}.flex-row[_ngcontent-%COMP%]{display:flex;flex-direction:row}.justify-start[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.justify-center[_ngcontent-%COMP%]{display:flex;justify-content:center}.justify-end[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.justify-evenly[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly}.justify-around[_ngcontent-%COMP%]{display:flex;justify-content:space-around}.justify-between[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.align-start[_ngcontent-%COMP%]{display:flex;align-items:flex-start}.align-center[_ngcontent-%COMP%]{display:flex;align-items:center}.align-end[_ngcontent-%COMP%]{display:flex;align-items:flex-end}"]}),n})()}];let J=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[c.Bz.forChild(w)],c.Bz]}),n})();var R=i(9277),Q=i(9721);let H=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[r.ez,d.u5,a.Pc,R.G,Q.x,J]]}),n})()}}]);