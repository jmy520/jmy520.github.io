"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6818],{6818:(V,u,o)=>{o.r(u),o.d(u,{TestThreeJsPageModule:()=>N});var f=o(9808),x=o(3075),l=o(8962),d=o(1192),g=o(655),M=o(7846),s=o(6682),O=o(1509),S=o(9011),v=o(5096),b=o(3654),j=o(7152),w=o(5773),J=o(8317),e=o(9863),R=o(947),L=o(9993),F=o(5830),Z=o(9609),z=o(5161),B=o(7873);const E=["appStatusContent"],A=["canvasRef"];function D(i,c){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-status-content",3,4),e.NdJ("retry",function(){return e.CHM(t),e.oxw().onRetry()}),e.TgZ(3,"div",5),e._UZ(4,"canvas",null,6),e.qZA()(),e.BQk()}}function Y(i,c){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-status-content",3,4),e.NdJ("retry",function(){return e.CHM(t),e.oxw().onRetry()}),e.TgZ(3,"div",5),e._uU(4,"pad layout here"),e.qZA()(),e.BQk()}}function G(i,c){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-status-content",3,4),e.NdJ("retry",function(){return e.CHM(t),e.oxw().onRetry()}),e.TgZ(3,"div",5),e._UZ(4,"canvas",null,6),e.qZA()(),e.BQk()}}const H=[{path:"",component:(()=>{class i extends M.n{constructor(t,n,a,r,C,y,P,m,T){super(t,n,a,r),this.loadingCtrl=t,this.toastCtrl=n,this.runtime=a,this.screenFitService=r,this.navCtrl=C,this.modalCtrl=y,this.api=P,this.router=m,this.themeService=T,this.subscribeResult=null,this.mCameraZ=20,this.filedOfView=70,this.nearClippingPane=1,this.farClippingPane=1e3}get canvas(){return this.canvasRef.nativeElement}ngOnInit(){this.subscribeResult=this.router.events.subscribe(t=>{t instanceof d.m2&&"/test-three-js"==t.url&&this.setPageTitle("TestThreeJs")})}ngOnDestroy(){this.subscribeResult&&(this.subscribeResult.unsubscribe(),this.subscribeResult=null)}initData(){return(0,g.mG)(this,void 0,void 0,function*(){this.appStatusContent.invokeSuccess(),setTimeout(()=>{this.createScene(),this.startRenderingLoop()},100)})}ionViewWillEnter(){this.setPageTitle("TestThreeJs")}ionViewDidEnter(){(()=>(0,g.mG)(this,void 0,void 0,function*(){yield this.initData()}))().catch(t=>{console.error("[init data errror]",t),this.appStatusContent.invokeError()})}getAspectRatio(){return this.canvas.clientWidth/this.canvas.clientHeight}createScene(){this.mScene=new s.xsS,this.mScene.background=(new s.Ilk).setHSL(.6,0,1),this.mScene.fog=new s.ybr(this.mScene.background,1,5e3);const t=this.getAspectRatio();this.mCamera=new s.cPb(this.filedOfView,t,this.nearClippingPane,this.farClippingPane),this.mCamera.position.z=this.mCameraZ,this.clock=new s.SUY,this.mControls=new j.z(this.mCamera,this.canvas),this.mControls.target.set(0,.5,0),this.mControls.update(),this.mControls.enablePan=!1,this.mControls.enableDamping=!0,this.addCube(),this.addLight(),this.testLine(),this.testText(),this.loadModel("assets/models/kooda_duck.glb")}addCube(){const t=new s.DvJ(6,6,6),n=new s.vBJ({color:39406});this.mCube=new s.Kj0(t,n),this.mCube.position.set(4,8,-6),this.mScene.add(this.mCube);const a=new s.DvJ(6,6,6),r=new s.vBJ({color:16750848});this.mCube02=new s.Kj0(a,r),this.mCube02.position.set(-4,4,-6),this.mScene.add(this.mCube02)}addLight(){const t=new s.cek(16777215,.5,0);t.position.set(5,5,20),this.mScene.add(t);const n=new s.cek(16777215,.5,0);n.position.set(-5,5,20),this.mScene.add(n);const a=new s.cek(16777215,.5,0);a.position.set(0,10,20),this.mScene.add(a)}loadModel(t){const n=new S._;n.setDecoderPath("js/libs/draco/gltf/"),this.mLoader=new O.E,this.mLoader.setDRACOLoader(n),this.mLoader.load(t,a=>{const r=a.scene;r.position.set(0,0,5),r.position.set(0,-8,-5),r.scale.set(.6,.6,.6),r.rotation.y=180,console.error(r),this.mScene.add(r),this.mMixer=new s.Xcj(r),this.mMixer.clipAction(a.animations[0]).play()})}animateCube(){this.mCube.rotation.y+=.01,this.mCube02.rotation.z+=.05}animateModel(){const t=this.clock.getDelta();this.mMixer&&this.mMixer.update(t)}testLoadObjModel(){(new s.dpR).load("assets/models/tree_uv.png",t=>{(new v.L).load("assets/models/tree.obj",n=>{n.traverse(a=>{a instanceof s.Kj0&&(a.material.map=t)}),n.scale.set(.05,.05,.05),n.position.set(0,-10,0),this.mScene.add(n)})}),(new b.v).load("assets/models/yellowblock.mtl",t=>{t.preload(),(new v.L).setMaterials(t).load("assets/models/yellowblock.obj",n=>{n.scale.set(.02,.02,.02),n.position.set(0,-10,0),this.mScene.add(n)})})}testLine(){const t=new s.nls({color:255}),n=[];n.push(new s.Pa4(-6,0,0),new s.Pa4(0,6,0),new s.Pa4(6,0,0),new s.Pa4(-6,0,0));const a=(new s.u9r).setFromPoints(n),r=new s.x12(a,t);this.mScene.add(r),setTimeout(()=>{this.mScene.remove(r),a.dispose(),t.dispose()},2e3)}testText(){const m=[new s.xoR({color:39321,flatShading:!0}),new s.xoR({color:39321})];(new w.J).load("assets/fonts/optimer_bold.typeface.json",U=>{const p=new J.M("Hello",{font:U,size:4,height:1,curveSegments:.8,bevelThickness:.4,bevelSize:.2,bevelEnabled:!0});p.computeBoundingBox();const K=-.5*(p.boundingBox.max.x-p.boundingBox.min.x),h=new s.Kj0(p,m);h.position.x=K,h.position.y=6,h.position.z=0,h.rotation.x=0,h.rotation.y=2*Math.PI,this.mScene.add(h)})}startRenderingLoop(){this.mRender=new s.CP7({canvas:this.canvas}),this.mRender.setPixelRatio(devicePixelRatio),this.mRender.setSize(this.canvas.clientWidth,this.canvas.clientHeight);const t=this;!function n(){requestAnimationFrame(n),t.animateCube(),t.animateModel(),t.mRender.render(t.mScene,t.mCamera)}()}onRetry(){(()=>(0,g.mG)(this,void 0,void 0,function*(){yield this.initData()}))().catch(t=>{console.error("[init data errror]",t),this.appStatusContent.invokeError()})}back(){this.navCtrl.back()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(l.HT),e.Y36(l.yF),e.Y36(R.t),e.Y36(L.v),e.Y36(l.SH),e.Y36(l.IN),e.Y36(F.s),e.Y36(d.F0),e.Y36(Z.f))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-test-three-js"]],viewQuery:function(t,n){if(1&t&&(e.Gf(E,5),e.Gf(A,5)),2&t){let a;e.iGM(a=e.CRH())&&(n.appStatusContent=a.first),e.iGM(a=e.CRH())&&(n.canvasRef=a.first)}},features:[e.qOj],decls:6,vars:9,consts:[["id","pageContent",3,"fullscreen","scrollEvents"],[1,"page-root","test-three-js"],[4,"ngIf"],[3,"retry"],["appStatusContent",""],[1,"app-container"],["canvasRef",""]],template:function(t,n){1&t&&(e.TgZ(0,"ion-content",0)(1,"div",1),e.YNc(2,D,6,0,"ng-container",2),e.YNc(3,Y,5,0,"ng-container",2),e.YNc(4,G,6,0,"ng-container",2),e.qZA(),e._UZ(5,"app-common-footer"),e.qZA()),2&t&&(e.Tol(n.screenFitService.screenCategory),e.Q6J("fullscreen",n.themeService.immersive)("scrollEvents",!0),e.xp6(1),e.Tol(n.screenFitService.screenCategory),e.xp6(1),e.Q6J("ngIf","desktop"==n.screenFitService.screenCategory),e.xp6(1),e.Q6J("ngIf","pad"==n.screenFitService.screenCategory),e.xp6(1),e.Q6J("ngIf","phone"==n.screenFitService.screenCategory))},directives:[l.W2,f.O5,z.D,B.X],styles:[".flex-col[_ngcontent-%COMP%]{display:flex;flex-direction:column}.flex-row[_ngcontent-%COMP%]{display:flex;flex-direction:row}.justify-start[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.justify-center[_ngcontent-%COMP%]{display:flex;justify-content:center}.justify-end[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.justify-evenly[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly}.justify-around[_ngcontent-%COMP%]{display:flex;justify-content:space-around}.justify-between[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.align-start[_ngcontent-%COMP%]{display:flex;align-items:flex-start}.align-center[_ngcontent-%COMP%]{display:flex;align-items:center}.align-end[_ngcontent-%COMP%]{display:flex;align-items:flex-end}div.page-root.test-three-js.desktop[_ngcontent-%COMP%]{padding:0}div.page-root.test-three-js.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]{padding:0}div.page-root.test-three-js.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{width:100vw;height:100vh}@supports (-webkit-touch-callout: none){div.page-root.test-three-js.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{height:calc(var(--vh, 1vh) * 100)}}div.page-root.test-three-js.phone[_ngcontent-%COMP%]{padding:0}div.page-root.test-three-js.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]{padding:0}div.page-root.test-three-js.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{width:100vw;height:100vh}@supports (-webkit-touch-callout: none){div.page-root.test-three-js.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]   canvas[_ngcontent-%COMP%]{height:calc(var(--vh, 1vh) * 100)}}"]}),i})()}];let k=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[d.Bz.forChild(H)],d.Bz]}),i})();var Q=o(9277),I=o(9721);let N=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[f.ez,x.u5,l.Pc,Q.G,I.x,k]]}),i})()}}]);