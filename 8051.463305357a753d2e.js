"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8051],{5732:(v,f,i)=>{i.d(f,{$:()=>g});var c=i(9863);let g=(()=>{class r{constructor(){}ngOnInit(){}}return r.\u0275fac=function(d){return new(d||r)},r.\u0275cmp=c.Xpm({type:r,selectors:[["app-wechat-open-page"]],decls:7,vars:0,consts:[[1,"weui-mask"],[1,"weui-dialog"],[1,"weui-dialog__bd"],[1,"weui-dialog__ft"],["href","weixin://","onclick","",1,"weui-dialog__btn","weui-dialog__btn_default"]],template:function(d,m){1&d&&(c.TgZ(0,"div",0)(1,"div",1)(2,"div",2),c._uU(3,"\u8bf7\u5728\u624b\u673a\u7aef\u6253\u5f00\u9875\u9762"),c.qZA(),c.TgZ(4,"div",3)(5,"a",4),c._uU(6,"\u786e\u5b9a"),c.qZA()()()())},styles:[""]}),r})()},8051:(v,f,i)=>{i.r(f),i.d(f,{AuthIdcardPageModule:()=>B});var c=i(9808),g=i(3075),r=i(8962),u=i(1192),d=i(655),m=i(7846),_=i(2752),l=i(8995),t=i(9863),M=i(947),O=i(9993),y=i(5830),x=i(4828),b=i(9609),w=i(5161),A=i(5732),T=i(7873);const I=["appStatusContent"];function k(o,s){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"app-status-content",3,4),t.NdJ("retry",function(){return t.CHM(n),t.oxw().onRetry()}),t._UZ(3,"app-wechat-open-page"),t.qZA(),t.BQk()}}function D(o,s){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"app-status-content",3,4),t.NdJ("retry",function(){return t.CHM(n),t.oxw().onRetry()}),t.TgZ(3,"div",5),t._uU(4,"pad layout here"),t.qZA()(),t.BQk()}}function F(o,s){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"app-status-content",3,4),t.NdJ("retry",function(){return t.CHM(n),t.oxw().onRetry()}),t.TgZ(3,"div",5)(4,"div",6)(5,"div",7)(6,"span"),t._uU(7," \u8bf7\u8f93\u5165\u60a8\u7684\u8eab\u4efd\u8bc1\u4fe1\u606f "),t.qZA()(),t.TgZ(8,"ion-item",8)(9,"ion-input",9),t.NdJ("ngModelChange",function(a){return t.CHM(n),t.oxw().formData.realName=a}),t.qZA()(),t.TgZ(10,"ion-item",8)(11,"ion-input",10),t.NdJ("keypress",function(a){return t.CHM(n),t.oxw().idNumberOnly(a)})("ngModelChange",function(a){return t.CHM(n),t.oxw().formData.identity=a}),t.qZA()(),t.TgZ(12,"ion-button",11),t.NdJ("click",function(){return t.CHM(n),t.oxw().onClickConfirm()}),t._uU(13," \u63d0\u4ea4 "),t.qZA()()()(),t.BQk()}if(2&o){const n=t.oxw();t.xp6(9),t.Q6J("ngModel",n.formData.realName),t.xp6(2),t.Q6J("ngModel",n.formData.identity),t.xp6(1),t.Q6J("disabled",n.loading)}}const N=[{path:"",component:(()=>{class o extends m.n{constructor(n,e,a,p,C,P,h,j,Y,J,S,U){super(n,e,a,p),this.loadingCtrl=n,this.toastCtrl=e,this.runtime=a,this.screenFitService=p,this.navCtrl=C,this.modalCtrl=P,this.api=h,this.router=j,this.routeInfo=Y,this.eventBus=J,this.location=S,this.themeService=U,this.subscribeResult=null,this.subscribeRouteInfo=null,this.loading=!1,this.formData={verificationCode:"",realName:"",identity:"",bankCardNo:"",bank:""},this.verificationCode="",this.to=""}ngOnInit(){this.subscribeResult=this.router.events.subscribe(n=>{n instanceof u.m2&&"/auth-idcard"==n.url&&this.setPageTitle("\u5b9e\u540d\u8ba4\u8bc1")}),this.subscribeRouteInfo=this.routeInfo.queryParams.subscribe(n=>{this.verificationCode=n.verificationCode,this.to=n.to})}ngOnDestroy(){this.subscribeResult&&(this.subscribeResult.unsubscribe(),this.subscribeResult=null),this.subscribeRouteInfo&&(this.subscribeRouteInfo.unsubscribe(),this.subscribeRouteInfo=null)}initData(){return(0,d.mG)(this,void 0,void 0,function*(){this.formData.verificationCode=this.verificationCode,this.appStatusContent.invokeSuccess()})}setPageTitle(n){super.setPageTitle(n),this.eventBus.emmitEvent("changeNavTitle",n),this.eventBus.emmitEvent("changeDefaultHeader","standard")}ionViewWillEnter(){this.setPageTitle("\u5b9e\u540d\u8ba4\u8bc1")}ionViewDidEnter(){(()=>(0,d.mG)(this,void 0,void 0,function*(){yield this.initData()}))().catch(n=>{console.error("[init data errror]",n),this.appStatusContent.invokeError()})}numberOnly(n){const e=n.which?n.which:n.keyCode;return!(e>31&&(e<48||e>57))}idNumberOnly(n){const e=n.which?n.which:n.keyCode;return 88===e||!(e>31&&(e<48||e>57))}checkFormData(){return _.E.isEmpty(this.formData.realName)?(this.showToast("\u8bf7\u8f93\u5165\u59d3\u540d",!0),!1):!_.E.isEmpty(this.formData.identity)||(this.showToast("\u8bf7\u8f93\u5165\u8eab\u4efd\u8bc1\u53f7\u7801",!0),!1)}onClickConfirm(){this.checkFormData()&&(this.loading=!0,(()=>(0,d.mG)(this,void 0,void 0,function*(){yield this.doConfirm()}))().catch(n=>{this.loading=!1,console.error(n)}))}checkIdCard(n){if(n=n.toUpperCase(),!/^[1-9]{1}[0-9]{14}$|^[1-9]{1}[0-9]{16}([0-9]|[xX])$/.test(n))return this.showToast("\u8eab\u4efd\u8bc1\u53f7\u683c\u5f0f\u4e0d\u6b63\u786e",!0),!1;if(18===n.length){const a=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2),p=new Array("1","0","X","9","8","7","6","5","4","3","2");let C=0;for(let h=0;h<17;h++)C+=n.substr(h,1)*a[h];if(p[C%11]!==n.substr(17,1))return this.showToast("\u8eab\u4efd\u8bc1\u53f7\u7801\u6821\u9a8c\u9519\u8bef\uff0c\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u8eab\u4efd\u8bc1\u53f7\u7801",!0),!1}return!0}checkName(n){return/^[\u4e00-\u9fa5]{2,6}$/.test(n)}doConfirm(){return(0,d.mG)(this,void 0,void 0,function*(){if(this.formData.realName.length<2||this.formData.realName.length>6)return this.showToast("\u8bf7\u8f93\u5165\u4e2d\u6587\u59d3\u540d",!0),void(this.loading=!1);if(!this.checkName(this.formData.realName))return this.showToast("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u4e2d\u6587\u59d3\u540d",!0),void(this.loading=!1);if(18!==this.formData.identity.length)return this.showToast("\u8bf7\u8f93\u516518\u4f4d\u8eab\u4efd\u8bc1\u53f7\u7801",!0),void(this.loading=!1);if(!this.checkIdCard(this.formData.identity))return this.showToast("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u8eab\u4efd\u8bc1\u53f7\u7801",!0),void(this.loading=!1);const n=yield this.api.userUpdateKyc({verificationCode:this.formData.verificationCode,idNumber:this.formData.identity,realName:this.formData.realName});if(200===n.code){const e=n.data;this.loading=!1,this.showToast("\u63d0\u4ea4\u5b9e\u540d\u8ba4\u8bc1\u4fe1\u606f\u6210\u529f\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85\u5ba1\u6838\u7ed3\u679c!");const a=l.w.convertRouteURL(this.router,["/settings"],{queryParams:{menu:"settings",index:0}});return l.w.locationReplace(a),this.back(),e}return this.showToast(`\u63d0\u4ea4\u5b9e\u540d\u8ba4\u8bc1\u4fe1\u606f\u5931\u8d25[${n.msg}]`,!0),Promise.reject({code:n.code,message:n.message})})}onRetry(){(()=>(0,d.mG)(this,void 0,void 0,function*(){yield this.initData()}))().catch(n=>{console.error("[init data errror]",n),this.appStatusContent.invokeError()})}back(){if("settings"===this.to){const n=l.w.convertRouteURL(this.router,["/settings"],{queryParams:{menu:"settings",index:0}});l.w.locationReplace(n)}else if("center"===this.to){const n=l.w.convertRouteURL(this.router,["/tabs/profile"],{queryParams:{menu:"center",index:0}});l.w.locationReplace(n)}else this.location.historyGo(-2)}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(r.HT),t.Y36(r.yF),t.Y36(M.t),t.Y36(O.v),t.Y36(r.SH),t.Y36(r.IN),t.Y36(y.s),t.Y36(u.F0),t.Y36(u.gz),t.Y36(x.Y),t.Y36(c.Ye),t.Y36(b.f))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-auth-idcard"]],viewQuery:function(n,e){if(1&n&&t.Gf(I,5),2&n){let a;t.iGM(a=t.CRH())&&(e.appStatusContent=a.first)}},features:[t.qOj],decls:6,vars:9,consts:[["id","pageContent",3,"fullscreen","scrollEvents"],[1,"page-root","auth-idcard"],[4,"ngIf"],[3,"retry"],["appStatusContent",""],[1,"app-container"],[1,"form-content"],[1,"form-top-title"],["lines","none",1,"ion-no-padding"],["type","text","placeholder","\u8bf7\u8f93\u5165\u59d3\u540d",3,"ngModel","ngModelChange"],["type","text","maxlength","18","placeholder","\u8bf7\u8f93\u5165\u8eab\u4efd\u8bc1\u53f7\u7801",3,"ngModel","keypress","ngModelChange"],["expand","block","fill","solid",3,"disabled","click"]],template:function(n,e){1&n&&(t.TgZ(0,"ion-content",0)(1,"div",1),t.YNc(2,k,4,0,"ng-container",2),t.YNc(3,D,5,0,"ng-container",2),t.YNc(4,F,14,3,"ng-container",2),t.qZA(),t._UZ(5,"app-common-footer"),t.qZA()),2&n&&(t.Tol(e.screenFitService.screenCategory),t.Q6J("fullscreen",e.themeService.immersive)("scrollEvents",!0),t.xp6(1),t.Tol(e.screenFitService.screenCategory),t.xp6(1),t.Q6J("ngIf","desktop"==e.screenFitService.screenCategory),t.xp6(1),t.Q6J("ngIf","pad"==e.screenFitService.screenCategory),t.xp6(1),t.Q6J("ngIf","phone"==e.screenFitService.screenCategory))},directives:[r.W2,c.O5,w.D,A.$,r.Ie,r.pK,r.j9,g.JJ,g.On,g.nD,r.YG,T.X],styles:[".flex-col[_ngcontent-%COMP%]{display:flex;flex-direction:column}.flex-row[_ngcontent-%COMP%]{display:flex;flex-direction:row}.justify-start[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.justify-center[_ngcontent-%COMP%]{display:flex;justify-content:center}.justify-end[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.justify-evenly[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly}.justify-around[_ngcontent-%COMP%]{display:flex;justify-content:space-around}.justify-between[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.align-start[_ngcontent-%COMP%]{display:flex;align-items:flex-start}.align-center[_ngcontent-%COMP%]{display:flex;align-items:center}.align-end[_ngcontent-%COMP%]{display:flex;align-items:flex-end}div.page-root.auth-idcard.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}div.page-root.auth-idcard.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.header[_ngcontent-%COMP%]{display:flex;align-items:center;width:700px;margin:0 auto}div.page-root.auth-idcard.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.header[_ngcontent-%COMP%] > div.back[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer}div.page-root.auth-idcard.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.header[_ngcontent-%COMP%] > div.back[_ngcontent-%COMP%]:hover > ion-icon[_ngcontent-%COMP%]{color:#e2aa6f}div.page-root.auth-idcard.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.header[_ngcontent-%COMP%] > div.back[_ngcontent-%COMP%]:hover > span[_ngcontent-%COMP%]{color:#e2aa6f}div.page-root.auth-idcard.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.header[_ngcontent-%COMP%] > div.back[_ngcontent-%COMP%] > ion-icon[_ngcontent-%COMP%]{display:block;font-weight:700;font-size:16px}div.page-root.auth-idcard.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.header[_ngcontent-%COMP%] > div.back[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{display:block;font-weight:700;margin-left:10px}div.page-root.auth-idcard.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.title[_ngcontent-%COMP%]{margin-top:30px}div.page-root.auth-idcard.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.title[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{display:block;font-size:18px;font-weight:600}div.page-root.auth-idcard.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.form-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:450px;margin-top:20px;padding:20px 30px;background-color:#fff;overflow:hidden}div.page-root.auth-idcard.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.form-content[_ngcontent-%COMP%] > ion-item[_ngcontent-%COMP%]{width:100%;margin-top:30px;--height: 48px;--border-color: #aaaaaa !important;--padding-start: 0px !important;--padding-end: 0px !important;--background: #eeeeee}div.page-root.auth-idcard.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.form-content[_ngcontent-%COMP%] > ion-item[_ngcontent-%COMP%] > ion-input[_ngcontent-%COMP%]{width:auto;font-size:16px}div.page-root.auth-idcard.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.form-content[_ngcontent-%COMP%] > ion-item[_ngcontent-%COMP%] > ion-select[_ngcontent-%COMP%]{padding:0 30px}div.page-root.auth-idcard.desktop[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.form-content[_ngcontent-%COMP%] > ion-button[_ngcontent-%COMP%]{width:100%;height:50px;margin-top:50px;--ion-color-primary: #3D464F;--color: #ffffff;font-size:14px;font-weight:600}div.page-root.auth-idcard.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center}div.page-root.auth-idcard.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.form-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%;margin-top:60px}div.page-root.auth-idcard.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.form-content[_ngcontent-%COMP%] > div.form-top-title[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;align-items:flex-start}div.page-root.auth-idcard.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.form-content[_ngcontent-%COMP%] > div.form-top-title[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{display:block;font-size:14px;font-weight:400;color:#aaa}div.page-root.auth-idcard.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.form-content[_ngcontent-%COMP%] > ion-item[_ngcontent-%COMP%]{width:100%;margin-top:20px;--height: 48px;--border-color: #aaaaaa !important;--padding-start: 10px !important;--padding-end: 10px !important;--background: #eeeeee}div.page-root.auth-idcard.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.form-content[_ngcontent-%COMP%] > ion-item[_ngcontent-%COMP%] > ion-input[_ngcontent-%COMP%]{width:auto;font-size:16px}div.page-root.auth-idcard.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.form-content[_ngcontent-%COMP%] > ion-item[_ngcontent-%COMP%] > ion-select[_ngcontent-%COMP%]{background-color:transparent;--padding-start: 10px !important;font-size:16px;width:100%}div.page-root.auth-idcard.phone[_ngcontent-%COMP%]   app-status-content[_ngcontent-%COMP%]   div.app-container[_ngcontent-%COMP%] > div.form-content[_ngcontent-%COMP%] > ion-button[_ngcontent-%COMP%]{width:100%;height:50px;margin-top:50px;--ion-color-primary: #3D464F;--color: #ffffff;font-size:14px;font-weight:600}"]}),o})()}];let R=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[u.Bz.forChild(N)],u.Bz]}),o})();var E=i(9277),Z=i(9721);let B=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[[c.ez,g.u5,r.Pc,E.G,Z.x,R]]}),o})()}}]);